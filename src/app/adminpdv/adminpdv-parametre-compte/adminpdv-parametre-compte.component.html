<div id="page-wrapper">
    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">Paramétrage des comptes</h1>
        </div>
    </div>

    <div class="row">
	    <div class="col-xs-12 col-md-12 col-lg-12">

	    	<button class="btn btn-primary" data-toggle="modal" data-target="#modalNewCaissier" style="margin-bottom: 1rem ;">Créer un compte Caissier</button>
	        
	        <div class="panel panel-default table-responsive">
	            <table class="table table-striped" [mfData]="monitoringAdminpdvUserpdv | dataFilterAdminpdvparametrecompte : filterQuery" #mf="mfDataTable"
	                   [mfRowsOnPage]="rowsOnPage" [(mfSortBy)]="sortBy" [(mfSortOrder)]="sortOrder">
	                <thead>
	                <tr>
	                    <th>#</th>
	                    <th><mfDefaultSorter by="pdv">pdv</mfDefaultSorter></th>
	                    <th><mfDefaultSorter by="adresse">Adresse</mfDefaultSorter></th>
	                    <th><mfDefaultSorter by="telephone">Telephone</mfDefaultSorter></th>
	                    <th><mfDefaultSorter [by]="sortByWordLength">Option</mfDefaultSorter></th>
	                    <th><mfDefaultSorter [by]="sortByWordLength">Status</mfDefaultSorter></th>
	                    <th><mfDefaultSorter>Action</mfDefaultSorter></th>
	                </tr>
	                </thead>
	                <tbody *ngIf="monitoringAdminpdvUserpdv">
	                <tr *ngFor="let item of mf.data; let i = index ">
	                    <td>{{ i + 1  }}</td>
	                    <td>{{item.pdv}}</td>
	                    <td>{{getAdress(item.adresse)}}</td>
	                    <td>{{item.telephone}}</td>
	                    <td>
	                    	<button type="button" class="btn btn-outline btn-warning" (click)="modif(item)" data-toggle="modal" data-target="#myModalModifUser">Modifier</button>
	                    </td>
	                    <td>
	                    	{{item.isconnect?'Connecté':'Deconnecté'}}
	                    </td>
	                    <td>
	                    	<button type="button" *ngIf="item.isconnect" class="btn btn-outline btn-danger" (click)="deconnexionsession(item,i)">Deconnecter</button>
	                    </td>
	                </tr>
	                </tbody>
	                <tfoot>
	                <tr>
	                </tr>
	                </tfoot>
	            </table>
	        </div>
	    </div>
	</div>
            
</div>

<!-- Modals -->
<div class="modal fade" id="myModalModifUser" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content"  *ngIf="modifuserpdv">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">Modification pwd de {{modifuserpdv.pdv}}</h4>
            </div>
            <div class="modal-body">
            	<h5 *ngIf="errorConfirm==true" style="color: red">Les données que vous avez saisies ne correspondent pas! Veuillez reprendre la saisie.</h5>
            	<div class="form-group input-group col-sm-8">
                    <span class="input-group-addon">Nouveau Pwd</span>
                    <input type="password" class="form-control" placeholder="Entrer Nouveau Pwd"  id="password" name="password" required [(ngModel)]="password" #Password="ngModel">
                </div>
            	<div class="form-group input-group col-sm-8"  [ngClass]="{'has-error': password!=confirmPassword && ConfirmPassword.valid, 'has-success': password==confirmPassword && Password.valid}">
                    <span class="input-group-addon">Confirmer Pwd</span>
                    <input id="confirmPassword" name="confirmPassword" type="password" class="form-control" placeholder="Entrer Confirmer Pwd" required [(ngModel)]="confirmPassword" #ConfirmPassword="ngModel">
                </div>
            </div>
            <div class="modal-footer text-center">
                <button type="button" class="btn btn-default" id="idmodalferme" data-dismiss="modal" #closeBtn>Annuler</button>
                <button type="button" (click)="validermodif()" [disabled]="!Password.valid || !ConfirmPassword.valid" class="btn btn-primary">Valider</button>
            </div>
        </div>
    </div>
</div>
                            

<div class="modal fade" id="modalNewCaissier" tabindex="-1" role="dialog" aria-labelledby="modalNewCaissier" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">Création compte Caissier</h4>
            </div>
            <div class="modal-body">
            	<h5 *ngIf="existLogin==true" style="color: red">Le login que vous avez renseigné est dèja utilisé. Veuillez saisir un login different.</h5>
			   <div class="row" id="inscription">
			            <div id="form" class="col-sm-12 col-xs-12">
			                <form #f="ngForm" name="form">
			                    <div  class="form-inline form-group">
			                            <input  type="text" id="prenom" required [(ngModel)]="prenom" name="prenom" placeholder="prenom" class="form-control" />
			                            <input  type="text" id="nom" [(ngModel)]="nom" required name="nom" placeholder="nom" class="form-control"/>
			                    </div>
			                    <div class="form-inline form-group">
			                        <input type="text" [(ngModel)]="email" name="email" required  name="email" placeholder="login" class="form-control"  />
			                        <input type="tel" [(ngModel)]="telephone" name="tel" required name="tel" placeholder="telephone" class="form-control"  />
			                    </div>
			                    <div class="form-group form-inline">
			                        <input type="text" [(ngModel)]="nometps" name="entreprise" required placeholder="nom entreprise" class="form-control" />
			                        <input type="text" [(ngModel)]="nomshop" name="boutique" placeholder="nom boutique en ligne(facultatif)" class="form-control" />
			                    </div>
			                    <div class="form-group">
			                        <label *ngIf="!region"> Région où se situe le point </label>
			                            <select #t [(ngModel)]="region" name="region" class="form-control" required (change)="departement(t.value)">
			                                <option *ngFor="let region of regions" [value]="region.id">{{region.name}}</option>
			                            </select>
			                        
			                    </div>
			                    <div class="form-group" *ngIf="region">
			                        <label *ngIf="!zone"> Votre Zone dans {{getRegionName(region)}} </label>
			                        <select name="zone" #d [(ngModel)]="zone"  class="form-control" required (change)="souszones(zone)"  placeholder="--veuillez choisir votre departement--">
			                            <option *ngFor="let dep of departements" [value]="dep.id">{{dep.name}}</option>
			                        </select>
			                    </div>

			                    <div class="form-group" *ngIf="zone">
			                        <label *ngIf="!souszone"> Votre sous zone dans {{getZoneName(zone)}} </label>
			                        <select name="sdep" class="form-control"  [(ngModel)]="souszone" required  placeholder="--veuillez choisir votre zone--">
			                            <option *ngFor="let sdep of sdepartements" [value]="sdep.name">{{sdep.name}}</option>
			                        </select>
			                    </div>
			                    <div class="form-group">
			                        <input name="adresse" required *ngIf="souszone" [(ngModel)]="adresse" type="text" placeholder="adresse exacte" class="form-control" />
			                    </div>
						        <button type="button" class="btn btn-default" id="idmodalferme" data-dismiss="modal" #closeBtn>Annuler</button>
			                    <input   type="button"  (click)="inscrire()" [disabled]="!f.form.valid" class="btn btn-success btn-block"  value="valider" />
			             </form>
			          </div>
			    </div>
            </div>
        </div>
    </div>

	<div *ngIf="this.loading">
	    <app-loader></app-loader>    
	</div>

</div>

<div *ngIf="this.loading">
    <app-loader></app-loader>    
</div>
